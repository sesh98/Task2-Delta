<!DOCTYPE html>
<html>
<head>
	<title>Game</title>
</head>
<style type="text/css">
	#myCanvas{
		background:black;
	}
</style>
<body>
<canvas id="myCanvas" width="480" height="324">
</body>
<script type="text/javascript">
	var canvas=document.getElementById("myCanvas");
	var ctx=canvas.getContext("2d");
	var manSize=10;
	var x=manSize;
	var y=canvas.height-manSize;
	/*var x=355;
	var y=canvas.height-manSize;*/
	var dx=1;
	var dy=1;
	var topPressed=false;
	var leftPressed=false;
	var rightPressed=false;
	var downPressed=false;
	var wallOffset=30;
	var wallPadding=70;
	var coinSize=4;
	var time=1300;
	var lives=3;

	function drawMan(){
		ctx.beginPath();
		ctx.arc(x,y,manSize,0,Math.PI*2);
		ctx.fillStyle="green";
		ctx.fill();
		ctx.closePath();
	}

	function moveMan(){
		//Left
		addEventListener("keydown",function(event){
			if(event.keyCode==37){
				leftPressed=true;
			} /* left=37,up=38,right=39,down=40*/
		});
		addEventListener("keyup",function(event){
			if(event.keyCode==37){
				leftPressed=false;
			}
		});
		if(leftPressed==true&&x>manSize){
			x-=dx;	
		}
		//Right
		addEventListener("keydown",function(event){
			if(event.keyCode==39){
				rightPressed=true;
			} /* left=37,up=38,right=39,down=40*/
		});
		addEventListener("keyup",function(event){
			if(event.keyCode==39){
				rightPressed=false;
			}
		});
		if(rightPressed==true&&x<canvas.width-manSize){
			x+=dx;
		}
		//Top
		addEventListener("keydown",function(event){
			if(event.keyCode==38){
				topPressed=true;
			} /* left=37,up=38,right=39,down=40*/
		});
		addEventListener("keyup",function(event){
			if(event.keyCode==38){
				topPressed=false;
			}
		});
		if(topPressed==true&&y>manSize){
			y-=dy;	
		}
		//Down
		addEventListener("keydown",function(event){
			if(event.keyCode==40){
				downPressed=true;
			} /* left=37,up=38,right=39,down=40*/
		});
		addEventListener("keyup",function(event){
			if(event.keyCode==40){
				downPressed=false;
			}
		});
		if(downPressed==true&&y<canvas.height-manSize){
			y+=dy;
		}
	}/*
	function drawCoins(){
		ctx.beginPath();
		ctx.arc(wallOffset*(1/3),wallOffset*(2/3),coinSize,0,Math.PI*2);
		ctx.arc((9/2)*wallOffset+wallPadding,canvas.height*(1/12),coinSize,0,Math.PI*2);
		ctx.fillStyle="gold";
		ctx.fill();
		ctx.closePath();
		var ctxx=canvas.getContext("2d");
		ctxx.beginPath();
		ctxx.arc(6*wallOffset+wallPadding-10,canvas.height*(5/12),coinSize,0,Math.PI*2);
		ctxx.arc(3*wallOffset+wallPadding+10,canvas.height*(11/12),coinSize,0,Math.PI*2);
		ctxx.fillStyle="gold";
		ctxx.fill();
		ctxx.closePath();
		var ctxxx=canvas.getContext("2d");
		ctxxx.beginPath();
		ctxxx.arc(canvas.width-manSize,canvas.height*(5/12),coinSize,0,Math.PI*2);
		ctxxx.arc(3*wallOffset+wallPadding+10,canvas.height*(11/12),coinSize,0,Math.PI*2);
		ctxxx.fillStyle="gold";
		ctxxx.fill();
		ctxxx.closePath();
	}*/
	function Timer(){
		ctx.font = "16px Arial";
    	ctx.fillStyle = "gold";
    	ctx.fillText("Time "+time, canvas.width-75, 20);
    	ctx.fillText("Lives "+lives, canvas.width-75, 60);
	}
	function drawWall(){
		ctx.beginPath();
		ctx.rect(wallOffset,canvas.height*(1/6),wallOffset,canvas.height*(5/6));
		ctx.rect(wallOffset,canvas.height*(1/6),(2*wallOffset)+wallPadding,wallOffset);
		ctx.rect(2*wallOffset+wallPadding,canvas.height*(1/6),wallOffset,canvas.height*(5/6));
		ctx.rect(6*wallOffset+wallPadding,0,wallPadding*(3/2),canvas.height);
		ctx.rect(7*wallOffset+(wallPadding*(5/2)),canvas.height*(1/3),wallPadding,canvas.height*(1/3));
		ctx.fillStyle="red";
		ctx.fill();
		ctx.closePath();

		var ctxx=canvas.getContext("2d");
		ctxx.beginPath();
		ctxx.moveTo(6*wallOffset+wallPadding,canvas.height);
		ctxx.lineTo(6*wallOffset+wallPadding,canvas.height-wallOffset);
		ctxx.lineTo(6*wallOffset+wallPadding+2*manSize,canvas.height-wallOffset);
		ctxx.lineTo(6*wallOffset+wallPadding+2*manSize,canvas.height);
		ctxx.moveTo(6*wallOffset+wallPadding+manSize*(2/3),canvas.height);
		ctxx.lineTo(6*wallOffset+wallPadding+manSize*(2/3),canvas.height-wallOffset);
		ctxx.moveTo(6*wallOffset+wallPadding+manSize*(4/3),canvas.height);
		ctxx.lineTo(6*wallOffset+wallPadding+manSize*(4/3),canvas.height-wallOffset);
		
		ctxx.moveTo(6*wallOffset+wallPadding*(5/2),wallOffset);
		ctxx.lineTo(6*wallOffset+wallPadding*(5/2)-2*manSize,wallOffset);
		ctxx.lineTo(6*wallOffset+wallPadding*(5/2)-2*manSize,0);
		ctxx.moveTo(6*wallOffset+wallPadding*(5/2)-manSize*(4/3),0);
		ctxx.lineTo(6*wallOffset+wallPadding*(5/2)-manSize*(4/3),wallOffset);
		ctxx.moveTo(6*wallOffset+wallPadding*(5/2)-manSize*(2/3),0);
		ctxx.lineTo(6*wallOffset+wallPadding*(5/2)-manSize*(2/3),wallOffset);
		ctxx.strokeStyle="blue";
		ctxx.stroke();

		var ctxxx=canvas.getContext("2d");
		ctxxx.beginPath();
		ctxx.moveTo(6*wallOffset+4*wallPadding,canvas.height);
		ctxx.lineTo(6*wallOffset+4*wallPadding,canvas.height-wallOffset);
		ctxx.lineTo(6*wallOffset+4*wallPadding+2*manSize,canvas.height-wallOffset);
		ctxx.lineTo(6*wallOffset+4*wallPadding+2*manSize,canvas.height);
		ctxx.moveTo(6*wallOffset+4*wallPadding+manSize*(2/3),canvas.height);
		ctxx.lineTo(6*wallOffset+4*wallPadding+manSize*(2/3),canvas.height-wallOffset);
		ctxx.moveTo(6*wallOffset+4*wallPadding+manSize*(4/3),canvas.height);
		ctxx.lineTo(6*wallOffset+4*wallPadding+manSize*(4/3),canvas.height-wallOffset);
		
		ctxxx.moveTo(canvas.width-2*manSize-40,canvas.height-wallOffset*(1/2));
		ctxxx.lineTo(canvas.width-2*manSize-10,canvas.height-wallOffset*(1/2));
		ctxxx.lineTo(canvas.width-2*manSize-20,canvas.height-wallOffset*(5/6));
		ctxxx.lineTo(canvas.width-2*manSize-20,canvas.height-wallOffset*(1/6));
		ctxxx.lineTo(canvas.width-2*manSize-10,canvas.height-wallOffset*(1/2));
		ctxxx.strokeStyle="pink";
		ctxxx.stroke();
	}
	function collide(){
		//bar 1
		if(x+dx+manSize>wallOffset&&y>canvas.height*(1/6)&&x<2*wallOffset){
			x-=dx;
		}
		//bar 2
		if(x>wallOffset&&x<(3*wallOffset+wallPadding)&&(y+dy+manSize)>canvas.height*(1/6)){
			y-=dy;
		}
		//bar 3
		if(x-dx-manSize<3*wallOffset+wallPadding&&x>2*wallOffset+wallPadding&&y>canvas.height*(1/6)){
			x+=dx;
		}
		//bar 4
		if(x+dx+manSize>6*wallOffset+wallPadding&&x<6*wallOffset+wallPadding*(5/2)){
			if(y>canvas.height-wallOffset){
				x=6*wallOffset+wallPadding*(5/2);
				y=manSize;
			}
			else
			x-=dx;
		}//bar 4 other side
		if(x-dx-manSize<6*wallOffset+wallPadding*(5/2)&&x>6*wallOffset+wallPadding){
			
			x+=dx;
		}
		//block top
		if(y+dy+manSize>canvas.height*(1/3)&&x>7*wallOffset+(wallPadding*(5/2))&&x<7*wallOffset+(wallPadding*(7/2))&&y<canvas.height*(2/3)){
			y-=dy;
		}//block left
		if(x+dx+manSize>7*wallOffset+(wallPadding*(5/2))&&x>6*wallOffset+wallPadding*(5/2)&&x<7*wallOffset+(wallPadding*3)&&y>canvas.height*(1/3)&&y<canvas.height*(2/3)){
			x-=dx;
		}
		//block down
		if(y-dy-manSize<canvas.height*(2/3)&&y>canvas.height*(1/3)&&x>7*wallOffset+(wallPadding*(5/2))&&x<7*wallOffset+(wallPadding*(7/2))){
			y+=dy;
		}
		//block right
		if(x-dx-manSize<7*wallOffset+(wallPadding*(7/2))&&y>canvas.height*(1/3)&&y<canvas.height*(2/3)&&x>7*wallOffset+3*wallPadding){
			x+=dx;
		}		
	}
	function win(){
		if(x==(canvas.width-3*manSize)&&(y>(canvas.height-wallOffset))&&time!=0){
				alert("Win");
				return 1;
		}
	}
	function draw(){
		if(time==0)
		{
			lives--;
			if(lives==0){
				alert("Out");
				document.location.reload();
			}
			else{
				time=1300;
				x=manSize;
				y=canvas.height-manSize;
			}
		}
		else
			time--
		ctx.clearRect(0,0,canvas.width,canvas.height);
		drawMan();
	//	drawCoins();
		drawWall();
		moveMan();
		collide();
		Timer();
		win();	
		if(win()==1){
			alert("congrats!Youve cleared level 1");
		}
		requestAnimationFrame(draw);
	}
	draw();
</script>
</html>
